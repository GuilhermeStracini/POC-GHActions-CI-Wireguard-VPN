name: Test VPN
on:
  pull_request:
  workflow_dispatch:

jobs:
 test-vpn:
    runs-on: ubuntu-latest

    steps:

    - name: Checkout code
      uses: actions/checkout@v4

    - name: Set up WireGuard Connection
      uses: niklaskeerl/easy-wireguard-action@v2
      with:
        WG_CONFIG_FILE: ${{ secrets.WIREGUARD_CONFIG }}

    - name: cURL webhooks.site
      run: |
        curl -A "POC-GHActions-CI-Wireguard-VPN (+https://github.com/GuilhermeStracini/POC-GHActions-CI-Wireguard-VPN)" ${{ secrets.WEBHOOK_ENDPOINT }}
